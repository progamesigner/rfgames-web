{{- $description := .Param "description" | default .Site.Params.Description | safeHTML -}}
{{- $fonts := "https://fonts.googleapis.com/css?family=Comfortaa:700|Roboto&display=swap" -}}
{{- $script := "main.js" | resources.Get | slice | resources.Concat "script.js" | fingerprint "sha512" -}}
{{- $style := "main.css" | resources.Get | slice | resources.Concat "style.css" | fingerprint "sha512" -}}
{{- $title := printf "%s | %s" .Title .Site.Title | safeHTML -}}

<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>
    <meta charset="utf-8">

    <title>{{ $title }}</title>

    <meta name="description" content="{{ $description }}">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="preconnect dns-prefetch" href="https://fonts.gstatic.com/" crossorigin>

    <link rel="preload" href="{{ $fonts }}" as="style" crossorigin>

    {{ hugo.Generator }}

    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ $title }}">
    <meta property="og:description" content="{{ $description }}">
    <meta property="og:url" content="{{ .Permalink }}">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{{ $title }}">
    <meta name="twitter:description" content="{{ $description }}">

    {{ with .Param "button" }}
        {{- $button := . | printf "buttons/%s.jpg" | resources.Get | fingerprint "sha512" -}}
        <meta property="og:image" content="{{ $button.Permalink }}">
        <meta name="twitter:image" content="{{ $button.Permalink }}">
    {{ else }}
        {{- $button := .Param "background" | default "default" | printf "backgrounds/%s-fallback.jpg" | resources.Get | fingerprint "sha512" -}}
        <meta property="og:image" content="{{ $button.Permalink }}">
        <meta name="twitter:image" content="{{ $button.Permalink }}">
    {{ end }}

    <meta name="theme-color" content="#0D0D0D">
    <link rel="icon" href="{{ "/favicon-32.png" | absURL }}" sizes="32x32">
    <link rel="icon" href="{{ "/favicon-70.png" | absURL }}" sizes="70x70">
    <link rel="icon" href="{{ "/favicon-128.png" | absURL }}" sizes="128x128">
    <link rel="icon" href="{{ "/favicon-150.png" | absURL }}" sizes="150x150">
    <link rel="icon" href="{{ "/favicon-152.png" | absURL }}" sizes="152x152">
    <link rel="icon" href="{{ "/favicon-167.png" | absURL }}" sizes="167x167">
    <link rel="icon" href="{{ "/favicon-180.png" | absURL }}" sizes="180x180">
    <link rel="icon" href="{{ "/favicon-192.png" | absURL }}" sizes="192x192">
    <link rel="icon" href="{{ "/favicon-196.png" | absURL }}" sizes="196x196">
    <link rel="icon" href="{{ "/favicon-310.png" | absURL }}" sizes="310x310">
    <link rel="icon" href="{{ "/favicon.png" | absURL }}" sizes="512x512">
    <link rel="shortcut icon" href="{{ "/favicon-128.png" | absURL }}" sizes="128x128">
    <link rel="shortcut icon" href="{{ "/favicon-192.png" | absURL }}" sizes="192x192">
    <link rel="shortcut icon" href="{{ "/favicon-196.png" | absURL }}" sizes="196x196">
    <link rel="apple-touch-icon" href="{{ "/favicon-152.png" | absURL }}" sizes="152x152">
    <link rel="apple-touch-icon" href="{{ "/favicon-167.png" | absURL }}" sizes="167x167">
    <link rel="apple-touch-icon" href="{{ "/favicon-180.png" | absURL }}" sizes="180x180">

    <link rel="stylesheet" href="{{ $fonts }}" crossorigin>
    <link rel="stylesheet" href="{{ $style.RelPermalink }}" integrity="{{ $style.Data.Integrity }}" crossorigin>
</head>

<body>
    {{ partial "layouts/header.html" . }}

    {{ block "main" . }}
        <main class="main">
            {{ .Content }}
        </main>
    {{ end }}

    {{ partial "layouts/footer.html" . }}

    <script>
        window.__shared_states__ = {
            {{- with .Site.Config.Services.GoogleAnalytics.ID -}}
            gtag: '{{ . }}',
            {{- end -}}
        };
    </script>
    <script src="{{ $script.RelPermalink }}" integrity="{{ $script.Data.Integrity }}" crossorigin async defer></script>
    {{ with .Site.Config.Services.Disqus.Shortname }}
        <script src="https://{{ . }}.disqus.com/embed.js" async defer></script>
    {{ end }}
</body>

</html>
