{{- $context := 0 | index . -}}
{{- $url := 1 | index . -}}
{{- $prefetchIds := 2 | index . | default slice -}}

{{- $data := dict -}}
{{- $entities := slice -}}

{{- if $prefetchIds | len | lt 0 -}}
    {{- $entities = slice $context $url $prefetchIds | partial "functions/gw2-api-paginated-data-by-ids.list" -}}
{{- else -}}
    {{- $entities = slice $context $url | partial "functions/gw2-api-paginated-data.list" -}}
{{- end -}}

{{- range $entities -}}
    {{- $id := .id | string -}}
    {{- $data = . | dict $id | merge $data -}}
{{- end -}}

{{- return $data -}}
